<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>属性选择</title>
<link rel="stylesheet" href="../css/main.css" />
<script type="text/javascript" src="../js/vue.min.js"></script>
<script type="text/javascript" src="../js/jquery-3.3.1.min.js"></script>
<!-- 引入样式 -->
<link rel="stylesheet" href="https://unpkg.com/element-ui@2.4.3/lib/theme-chalk/index.css">
<!-- 引入组件库 -->
<script src="https://unpkg.com/element-ui@2.4.3/lib/index.js"></script>
</head>
<body>



<div id="app">
<el-row>
	<el-col :span="4">
	<div class="topbar">
		&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;
	</div>
	</el-col>
	<el-col :span="4">
	<div class="topbar">
  		<el-input  v-model="inputkey" placeholder="请输入关键字" @change="search" prefix-icon="el-icon-search"></el-input>
	</div>
	</el-col>
</el-row>

<el-row>
<el-col :span="4">
<table>
       <tr v-for="item in catList">
           <td><el-button type="primary"  @click="showitem(item)">{{item.name}}</el-button></td>
       </tr>
</table>    
</el-col>
<el-col :span="12">
<table>
            <tr>
             	<td width="160px">键值</td>
            	<td width="160px">名称</td>
                <td width="200px">完整名称</td>
                <td width="200px">操作</td>
            </tr>
            <tr v-for="item1 in dataList">
            	<td>
               		{{item1.key}}
				</td>
            	<td>{{item1.name}}</td>
                
                <td>
                	<el-input  v-model="item1.fullName"></el-input>
                </td>
                <td>
                	<el-button type="primary" @click="select(item1)">选择</el-button>
                </td>
            </tr>
        </table>
        </el-col>
</div>

<script type="text/javascript">

$.ajaxSetup({  
    contentType : 'application/json'  
});


     new Vue({
            el:'#app',
            data:{
                catList:"",
                dataList:"",
                dataListFull:"",
                inputkey:"",
                dialogVisible:false,
                form: {
                    name: '',
                    description: '',
                    value: ''
                },
                formLabelWidth: '120px'
            },
            created:function(){
            	var url="/admin/getCategories";
        	    var _self = this;
        	    $.get(url, function (data) {
        	        _self.catList = data.list;
        	   });
            },
            methods:{
            	refreshData:function()
            	{
            		var url="/admin/getCategories";
            	    var _self = this;
            	    $.get(url, function (data) {
            	    	_self.catList = data.list;
            	   });
            	},
            	showitem:function(indata)
				{
            		 var _self = this;
            		
					$.ajax({
							url: "/admin/getCategoryAttrs",
							datatype:"json",
							type:'post',
							data:JSON.stringify(indata),
							success:function(data){
								_self.dataList = data.list;
								_self.dataListFull = data.list;
							}
					});  		
				},
				selectitem:function(indata)
				{
					
				},
				search:function()
				{
					
					var _self=this;
                    var tab=_self.dataListFull;
                    if(_self.inputkey!="")
                    {                                     
                    	_self.dataList=[];                     
                       for(i in tab) 
                       {
                            if(tab[i].name.indexOf(_self.inputkey) >= 0) 
                            {
                            	_self.dataList.push(tab[i]);
                            }
                        }
                    }
                    else
                        {
                    	_self.dataList = _self.dataListFull;
                        }
                    
				}
            }
                
          });

     //new Vue().$mount('#app');
</script>
</body>
</html>